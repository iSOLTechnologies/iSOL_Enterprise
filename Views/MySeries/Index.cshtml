@model iSOL_Enterprise.Models.Series.tbl_NNM1
@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{
    ViewBag.title1 = "Series";
    ViewBag.title2 = " / Add Series";
    ViewData["Title"] = "Series";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="https://code.jquery.com/jquery-3.6.3.slim.js" integrity="sha256-DKU1CmJ8kBuEwumaLuh9Tl/6ZB6jzGOBV/5YpNE2BWc=" crossorigin="anonymous"></script>
<!-- Render Body <Start> -->
<!--begin::Subheader-->
<link href="~/css/commonstyle.css" rel="stylesheet" />
<!--end::Subheader-->
<!--begin::Entry-->

 <form asp-action="AddSeries" asp-controller="MySeries" method="post">
<div class="container mt-5">

    <!--begin::Card-->
    <div class="card card-custom">
        <div class="card-header">
            <div class="card-title">
                <span class="card-icon">
                    <i class="flaticon-notepad text-primary"></i>
                </span>
                <h3 class="card-label">Detail</h3>
            </div>
           @* <div class="card-toolbar">
                <button class="bt btn-brand"  type="button">
                    Add
                </button>
            
                <!--end::Button-->
            </div>*@
            <div class="card-toolbar">
            <div class="btn-group">                 
                <button type="button" id="SeriesbtnAdd" class="btn btn-primary font-weight-bolder" data-toggle="modal" data-target="#SeriesModal">
                  + Add Series
                </button>
            </div>
            </div> 
        </div>
        <div class="card-body ">

          <div class="row">
          <div class="col-md-4 mb-5">
                        <select id="H_ObjectCode" asp-items="@ViewBag.SeriesDrpDwn" class="form-control form-select">
                  <option value="All" selected>-- Select All --</option>
              </select>
          </div>
          <div class="col-md-4"></div>
          </div>

            <!--begin: Datatable-->
            <table class="table table-striped- table-bordered table-hover table-checkable " id="SeriesTable">
                <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
            </table>

            <!--end: Datatable-->
        </div>
    </div>

</div>
<!--end::Entry-->
<!--Modal Start-->


<!-- Modal-->
<div class="modal fade" id="SeriesModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Series</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i aria-hidden="true" class="ki ki-close" style="color:red;"></i>
                </button>
            </div>
            <div class="modal-body">
               <div class="card card-custom">
 <!--begin::Form-->
 
  <div class="card-body"> 
   <div class="form-group row">
    <label  class="col-2 col-form-label">Document</label>
    <div class="col-10">
     <select id="ObjectCode" asp-for="ObjectCode" asp-items="@ViewBag.SeriesDrpDwn" class="form-control form-select">
     </select>
    </div>
   </div> 
   <div class="form-group row">
    <label  class="col-2 col-form-label">Series Name</label>
    <div class="col-10">
     <input required class="form-control" type="text" asp-for="SeriesName" id="SeriesName"/>
    </div>
   </div>  
   <div class="form-group row">
    <label  class="col-2 col-form-label">Initial Number</label>
    <div class="col-10">
     <input required class="form-control" type="number" asp-for="InitialNum" id="InitialNumber"/>
    </div>
   </div>   
   <div class="form-group row">
    <label  class="col-2 col-form-label">Last Number</label>
    <div class="col-10">
     <input required class="form-control" type="number" asp-for="LastNum" id="LastNumber"/>
    </div>
   </div>   
   <div class="form-group row">
    <label  class="col-2 col-form-label">Prefix</label>
    <div class="col-10">
     <input required class="form-control" type="text" asp-for="BeginStr" id="BeginStr"/>
    </div>
   </div> 
 









  </div>
 
</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-light-danger font-weight-bold" data-dismiss="modal">Close</button>
                <button type="submit" id="ADDD" class="btn btn-primary font-weight-bold">Add</button>
            </div>
        </div>
    </div>
</div>
 </form>
<!--Modal End-->




<!-- Render Body <End> -->

<script>
    var datatable;
        $(document).on('change', '#H_ObjectCode', function () {
            generateTable($('#H_ObjectCode').val());


        //if ($('#H_ObjectCode').val() == 'All') {
        //        $('#SeriesbtnAdd').attr('disabled',true);
        //    }else{
        //        $('#SeriesbtnAdd').attr('disabled',false);
        //    }
    })
    //    $(document).on('click', '#SeriesbtnAdd', function () { 
    //        $('#ObjectCodeDisplay').val($('#ObjectCode option:selected').text());            
    //}) 

    
    function generateTable(objectCode) {

        datatable = $('#SeriesTable').DataTable({
            responsive: true,
            searching: true,
            ordering: false,
            //   order: [[2, 'asc']],
            ordering: false,
            "ajax": {

                // url: '/HrAdmin/GetAttendanceList_MainLines?Date=' + $('#FilterDate').val(),
                url: '/MySeries/GetNNM1/',
                data : {ObjectCode :objectCode}
            },

            layout: {
                scroll: false, // enable/disable datatable scroll both horizontal and vertical when needed.
                // height: 450, // datatable's body's fixed height
                footer: false, // display/hide footer
            },

            // column sorting
            sortable: true,
            pagination: true,
            destroy: true,
            //   async: false,
            search: {
                input: $('#generalSearch'),
            },
            columns: [               
                {
                    data: 'seriesName', title: 'Series Name'

                },             
                {
                    data: 'pageName', title: 'Page Name'

                },
                {
                    data: 'initialNum', title: 'Initial Number'

                },
                {
                    data: 'lastNum', title: 'Last Number'
                    

                },
                {
                    data: 'beginStr', title: 'Prefix' 

                }
                ,]
        });

    }


     










    $(document).ready(function () 
    {
        //if($('#H_ObjectCode').val() == 'All'){
        //        $('#SeriesbtnAdd').attr('disabled',true);
        // }
        generateTable($('#H_ObjectCode').val());
    });



    //$(document).on('click', '#btnFetchSaleQuotation', function (e) 
    //{

    //    var guid = $(this).attr("guid");

    //    window.location.href = '/SaleQuotation/EditSaleQuotationMaster/' + guid + '';

    //});
    //function Mastercheck() {
    //    if (document.getElementById('Mastercheck').checked == true) {
    //        $("#AttTable tr").each(function () {
    //            $(this).find("#chckbox").prop("checked", true);
    //        });
    //    } else {
    //        $("#AttTable  tr").each(function () {
    //            $(this).find("#chckbox").prop("checked", false);
    //        });
    //    }
    //}
 
   

    //$(document).on('click', '#btnPostToSap' , function() 
    //{
    //    $(this).addClass('kt-spinner kt-spinner--right kt-spinner--md kt-spinner--light');
    //    $(this).attr('disabled', true);
        
    //    let checkedIDs = [];

    //    $('#AttTable tbody tr').each(function (index, item) {
            
    //         let CheckBoxObj = $(this).find('#chckbox');

    //            if ($(CheckBoxObj).is(":checked"))
    //            checkedIDs.push($(CheckBoxObj).attr('guid'));
            

    //    });
    //    if(checkedIDs.length > 0 ) 
    //    {
    //        $(".loading_ic").addClass('overlay');
    //        $(".loading_ic").show();
    //        $.post("Common/PostToSap", {checkedIDs : checkedIDs , ObjectCode : 23 } , function(response) 
    //        {
    //            if (response.success) 
    //            {
    //                $("#btnPostToSap").removeClass('kt-spinner kt-spinner--right kt-spinner--md kt-spinner--light');
    //                $("#btnPostToSap").attr('disabled', false);

    //                toastr.success(response.message);
    //                $(".loading_ic").removeClass('overlay dark');
    //                $(".loading_ic").hide();
    //                datatable.ajax.reload();
    //            }         
    //            else {
    //                $("#btnPostToSap").removeClass('kt-spinner kt-spinner--right kt-spinner--md kt-spinner--light');
    //                $("#btnPostToSap").attr('disabled', false);
    //                toastr.error(response.message);
    //                $(".loading_ic").removeClass('overlay dark');
    //                $(".loading_ic").hide();
    //                datatable.ajax.reload();
    //            }

    //        });
    //    }
    //    else
    //    {
    //        $("#btnPostToSap").removeClass('kt-spinner kt-spinner--right kt-spinner--md kt-spinner--light');
    //        $("#btnPostToSap").attr('disabled', false);
    //        toastr.warning("Documents not Selected !!");
    //    }
            
    //});



</script>
